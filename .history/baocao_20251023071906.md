1. Tổng quan hệ thống gợi ý thông minh
Hệ thống gợi ý game được xây dựng dựa trên trí tuệ nhân tạo (AI) và Machine Learning, bao gồm 3 loại gợi ý chính, mỗi loại phục vụ mục đích và tình huống sử dụng khác nhau:
1.1 Ba loại hệ thống gợi ý
Loại 1: Gợi ý dựa trên toàn bộ lịch sử (All-time Recommendations)
-	Phân tích tất cả dữ liệu tương tác của user từ khi đăng ký
-	Phù hợp cho: Trang chủ, khám phá game mới, gợi ý tổng quát
-	Đặc điểm: Ổn định, phản ánh sở thích lâu dài của user
Loại 2: Gợi ý dựa trên 7 ngày gần đây (Recent 7-day Recommendations)
-	Chỉ phân tích hành vi user trong 7 ngày vừa qua
-	Phù hợp cho: Trang cá nhân, “What's new for you”, trending với user
-	Đặc điểm: Dynamic, phản ánh xu hướng hiện tại, sở thích đang thay đổi
Loại 3: Gợi ý game tương tự (Similar Games Recommendations)
-	Dựa trên sự tương đồng nội dung với một game cụ thể
-	Phù hợp cho: Trang chi tiết game, “You may also like”, “Similar to X”
-	Đặc điểm: Context-aware, không phụ thuộc user, phù hợp cold-start
Đặc điểm chung của cả 3 loại:
-	Kết hợp Collaborative Filtering, Content-Based Filtering, và Demographic Filtering
-	Sử dụng SVD (Singular Value Decomposition) để phân tích ma trận user-item
-	Dynamic weighting tự động điều chỉnh trọng số các phương pháp
-	Hỗ trợ keyword search với trọng số cao khi có từ khóa tìm kiếm

1.1.1 Bảng tóm tắt trọng số (Weights Summary)

| Tình huống | SVD | Content | Demographic | Keyword |
|-----------|-----|---------|-------------|---------|
| **User có lịch sử - KHÔNG có keyword** | 45% | 35% | 20% | 0% |
| **User có lịch sử - CÓ keyword** | 15% | 15% | 10% | 60% |
| **Cold Start - KHÔNG có keyword** | 70% | 0% | 30% | 0% |
| **Cold Start - CÓ keyword** | 30% | 0% | 10% | 60% |

Giải thích:
-	User có lịch sử: Có đủ dữ liệu tương tác (purchased, favorite, view)
-	Cold Start: User mới, chưa có lịch sử tương tác
-	Keyword: User tìm kiếm với từ khóa cụ thể (VD: "hành động", "game giá rẻ")
-	Tổng trọng số luôn = 100% (sum of weights = 1.0)

Keyword được mở rộng qua library.json:
-	74 categories (Action, Horror, cheap, multiplayer, etc.)
-	Map từ tiếng Việt → tiếng Anh + synonyms
-	Chỉ mở rộng 1 lần (không đệ quy)
-	Tìm trong các field: name (3.0×), genre (2.5×), description (2.0×), publisher/platform/language (1.5×)
1.2 LOẠI 1: Gợi ý dựa trên toàn bộ lịch sử (All-time Recommendations)
1.2.1 Mô tả và mục đích
Loại gợi ý này phân tích toàn bộ lịch sử tương tác của user từ khi đăng ký tài khoản đến hiện tại, giúp hiểu được sở thích tổng thể và lâu dài của người dùng.
Mục đích sử dụng:
-	Trang chủ: Hiển thị game phù hợp với sở thích tổng quát
-	Danh sách “Recommended for You”: Gợi ý cá nhân hóa
-	Email marketing: Gửi game mới phù hợp với profile user
-	Section “You might also like”: Gợi ý chung
Ưu điểm:
-	Ổn định, không thay đổi đột ngột
-	Phản ánh đầy đủ sở thích của user
-	Độ chính xác cao với user có nhiều tương tác
-	Phù hợp cho long-term personalization
Nhược điểm:
-	Không phản ánh sự thay đổi sở thích gần đây
-	Cold start problem với user mới
-	Có thể bỏ lỡ xu hướng trending mới
1.2.2 Cách hoạt động chi tiết
Bước 1: Thu thập dữ liệu all-time
-	Truy vấn tất cả interactions của user từ database:
o	purchased_games: Game đã mua (từ lúc đăng ký đến nay)
o	favorite_games: Game yêu thích (wishlist)
o	view_history: Lịch sử xem game
o	reviews: Đánh giá và rating đã đưa ra
-	Không giới hạn thời gian, lấy toàn bộ dữ liệu
Bước 2: Tính toán trọng số tương tác
-	Purchase + Review với rating:
o	 Rating 5 sao: weight = 5.0 (rất thích)
o	 Rating 4 sao: weight = 4.0 (thích)
o	Rating 3 sao: weight = 3.0 (bình thường)
o	Rating 2 sao: weight = 2.0 (không thích)
o	Rating 1 sao: weight = 1.0 (rất không thích)
-	Purchase không review: weight = 3.0
-	Favorite/Wishlist: weight = 5.0
-	View: weight = 0.5 × view_count
Bước 3: Xây dựng User Profile
-	Tổng hợp từ tất cả interactions có trọng số
-	Xác định:
o	Top genres user thích (VD: Action 35%, RPG 28%, Strategy 20%)
o	Top publishers (VD: EA Sports 25%, Ubisoft 18%)
o	Price range trung bình (VD: 500k-800k VND)
o	Preferred platforms (VD: Windows 80%, PlayStation 15%)
o	Age rating preferences (VD: Mature 60%, Everyone 30%)
Bước 4: Chạy 4 phương pháp gợi ý
a)	SVD Collaborative Filtering (45% weight nếu không có keyword):
-	Sử dụng ma trận user-item đã train với SVD (k=2 factors)
-	Dự đoán rating user sẽ cho các game chưa mua
-	Công thức: predicted_rating = U × Σ × V^T + user_mean
-	Trả về top games có predicted rating cao nhất
b)	Content-Based Filtering (35% weight nếu không có keyword):
-	Tính content similarity giữa games user đã thích và tất cả games khác
-	Sử dụng 2 loại features:
o	**Text features**: TF-IDF cho genre, publisher, platform, mode, language, description (genre được lặp lại 3 lần để tăng trọng số)
o	**Numeric features**: Normalization cho price, rating, downloads, capacity, release_year, CPU score, GPU score, RAM
-	Kết hợp: Combined Matrix = Text Features (1×) + Numeric Features (0.5×)
-	Cosine similarity giữa game vectors
-	Trả về games có similarity cao nhất
c)	Demographic Filtering (20% weight nếu không có keyword):
-	Tìm users có age và gender tương tự
-	Tính demographic similarity:
o	Age difference: càng gần càng tốt (max 5 tuổi)
o	Gender match: cùng giới tính = 1.0, khác = 0.5
o	Combined: age_weight × gender_weight
-	Lấy games mà similar users đã thích
-	Trả về games phổ biến trong nhóm demographic
d)	Keyword-Based Filtering (0% nếu không có keyword, 60% nếu có):
-	Nếu user search với keyword (VD: "hành động", "zombie", "open world")
-	Query được mở rộng thông qua library.json (expand_query):
    o	Tìm keyword trong library để mở rộng từ tiếng Việt → tiếng Anh + synonyms
    o	VD: "hành động" → "hành động action fighting combat fast-paced intense kịch tính nam"
    o	Chỉ mở rộng 1 lần duy nhất (không mở rộng đệ quy)
-	Tìm games có keyword trong các field với trọng số khác nhau:
    o	name: weight × 3.0 (quan trọng nhất)
    o	genre: weight × 2.5 (rất quan trọng)
    o	description: weight × 2.0 (quan trọng)
    o	publisher: weight × 1.5
    o	platform: weight × 1.5
    o	language: weight × 1.5
-	Trọng số cao để ưu tiên kết quả search
Bước 5: Ensemble và tính điểm tổng hợp
-	KHÔNG có keyword:
    o	Final score = SVD_score × 0.45 + Content_score × 0.35 + Demo_score × 0.20
-	CÓ keyword:
    o	Final score = SVD_score × 0.15 + Content_score × 0.15 + Demo_score × 0.10 + Keyword_score × 0.60
-	Normalize các scores về [0, 1] trước khi kết hợp
Bước 6: Adaptive Boosting (tùy chọn)
-	Phân tích user preferences từ all-time data
-	Boost games match với preferences:
o	Publisher match: boost × 1.2
o	Genre match: boost × 1.2
o	Price range match: boost × 1.2
o	Platform match: boost × 1.2
-	Total boost factor: 0.6 - 2.0
Bước 7: Lọc và sắp xếp
-	Loại bỏ games đã mua và đã thích
-	Giữ lại games đã xem (để re-recommend)
-	Sắp xếp theo final score giảm dần
-	Trả về top N games (default N=10)
1.2.3 Ví dụ minh họa
User A profile:
-	Đã mua: GTA V (5★), FIFA 23 (4★), The Witcher 3 (5★)
-	Wishlist: Red Dead Redemption 2, Cyberpunk 2077
-	Viewed: Assassin's Creed Valhalla (3 lần)
Phân tích preferences:
-	Top genres: Action (40%), RPG (35%), Sports (25%)
-	Top publishers: Rockstar Games (40%), CD Projekt Red (30%)
-	Price range: 600k-900k VND
-	Preferred platform: Windows
Gợi ý all-time:
1. Red Dead Redemption 2 (score 0.89) - Rockstar, Open World, match preferences
2. Cyberpunk 2077 (score 0.85) - CD Projekt Red, RPG, match preferences
3. Witcher 3 DLC (score 0.82) - Same series, RPG
4. Watch Dogs Legion (score 0.78) - Action, Open World
5. Assassin's Creed Odyssey (score 0.75) - Action RPG
1.3 LOẠI 2: Gợi ý dựa trên 7 ngày gần đây (Recent 7-day Recommendations)
1.3.1 Mô tả và mục đích
Loại gợi ý này chỉ phân tích hành vi của user trong 7 ngày vừa qua, giúp nắm bắt xu hướng và sở thích hiện tại đang thay đổi.
Mục đích sử dụng:
-	Trang profile: “Your recent interests”
-	Notification: “Based on your recent activity”
-	“What's trending for you”: Xu hướng cá nhân
-	Dynamic recommendations thay đổi hàng tuần
Ưu điểm:
-	Phản ánh sở thích hiện tại, đang thay đổi
-	Nhanh nhạy với xu hướng mới
-	Phát hiện sự thay đổi trong hành vi user
-	Cập nhật liên tục, dynamic
Nhược điểm:
-	Không ổn định, thay đổi nhanh
-	Dữ liệu ít hơn → có thể kém chính xác
-	Không phù hợp với user ít active
1.3.2 Cách hoạt động chi tiết
Bước 1: Lọc dữ liệu 7 ngày gần đây
-	Sử dụng SQLite database (user_interactions.db) với timestamps
-	Query: SELECT * FROM user_interactions WHERE user_id = ? AND timestamp >= ?
-	Cutoff date: datetime.now() - timedelta(days=7)
-	Chỉ lấy interactions trong 7 ngày vừa qua
Dữ liệu lọc được:
-	Recent purchases (games mua trong 7 ngày)
-	Recent favorites (thêm vào wishlist trong 7 ngày)
-	Recent views (xem trong 7 ngày)
-	Recent reviews (đánh giá trong 7 ngày)
Bước 2: Xây dựng Recent Profile
-	Tương tự all-time profile nhưng chỉ từ recent data
-	Recent preferred genres (có thể khác với all-time)
-	Recent price range (có thể thay đổi do sale, event)
-	Recent publishers
-	Recent keywords (trích xuất từ recent interactions)
So sánh với All-time Profile:
-	Phát hiện sự thay đổi (trend shift)
-	VD: All-time thích Action 60%, RPG 30%
     	Recent 7-day thích RPG 70%, Action 20%
     	→ User đang chuyển sang thích RPG hơn
Bước 3: Chạy 4 phương pháp với Recent Data
a)	SVD Collaborative Filtering:
-	Sử dụng cùng SVD model (train trên all data)
-	Nhưng chỉ xét recent interactions để tính user vector
-	Weight: 15% (nếu có keyword) hoặc 45% (nếu không)
b)	Content-Based Filtering:
-	Tính similarity với games user recently interacted
-	Ưu tiên games tương tự với recent interests
-	Weight: 15% (có keyword) hoặc 35% (không keyword)
c)	Demographic Filtering:
-	Tìm users có demographic tương tự VÀ có recent activity giống nhau
-	Xét games mà similar users recently liked
-	Weight: 10% (có keyword) hoặc 20% (không keyword)
d)	Keyword-Based Filtering:
-	Mở rộng query thông qua library.json (expand_query function)
    o	Map từ tiếng Việt sang tiếng Anh + synonyms
    o	VD: "game giá rẻ" → "game giá rẻ cheap low price affordable budget"
-	Tính keyword score cho từng game dựa trên field weights
-	Weight: 60% (có keyword) hoặc 0% (không keyword)
Bước 4: Adaptive Boosting với Recent Preferences
-	Boost games match với recent preferences (7-day):
o	Recent genre match: boost × 1.2
o	Recent publisher match: boost × 1.2
o	Recent price range match: boost × 1.2
-	Boost factor mạnh hơn all-time vì data gần đây
Bước 5: Temporal Impact
-	Chỉ xét interactions trong 7 ngày gần đây (cutoff date)
-	Sử dụng timestamp filter trong SQLite query:
o	WHERE timestamp >= (datetime.now() - 7 days)
-	Tất cả interactions trong 7 ngày được tính với trọng số đầy đủ
-	Interactions ngoài 7 ngày bị loại bỏ hoàn toàn (không tính)
Bước 6: Lọc và sắp xếp
-	Loại bỏ games đã mua trong 7 ngày (đã có rồi)
-	Giữ lại games trong wishlist để nhắc nhở
-	Sắp xếp theo final score (sau boost)
-	Trả về top N games
1.3.3 So sánh All-time vs 7-day Recommendations
Temporal Impact Analysis:
-	Tạo biểu đồ so sánh:
o	Base scores (all-time, không boost)
o	7-day boosted scores (với adaptive boosting)
o	Score change (impact)
-	Games được boost lên cao hơn do match recent preferences
-	Games không match bị giảm score hoặc removed
Ví dụ:
-	Game A: Base 0.75 → 7-day 0.92 (+0.17) ← Match recent genre
-	Game B: Base 0.68 → 7-day 0.45 (-0.23) ← Không match recent interests
-	Game C: Base 0.82 → 7-day REMOVED ← User đã mua trong 7 ngày
1.3.4 Ví dụ minh họa
User A - All-time profile:
-	Thích: Action 60%, Sports 30%, RPG 10%
User A - Recent 7 days:
-	Đã mua: Elden Ring (RPG, 5★)
-	Đã xem: Dark Souls 3, Sekiro, Bloodborne (tất cả RPG, Souls-like)
-	Recent profile: RPG 80%, Action 15%, Souls-like 70%
→ Sở thích đang chuyển từ Action/Sports sang RPG Souls-like
Gợi ý 7-day:
1. Dark Souls 3 (score 0.94) - Souls-like, match recent
2. Sekiro (score 0.91) - FromSoftware, Souls-like
3. Bloodborne (score 0.88) - Souls-like, similar
4. Demon's Souls (score 0.85) - Same genre
5. Nioh 2 (score 0.82) - Souls-like gameplay
So với All-time recommendations (có thể khác):
1. FIFA 24 (Action/Sports - old preference)
2. GTA VI (Action - old preference)
3. Call of Duty (Action - old preference)
→ 7-day recommendations phù hợp với sở thích hiện tại hơn
1.4 LOẠI 3: Gợi ý game tương tự (Similar Games Recommendations)
1.4.1 Mô tả và mục đích
Loại gợi ý này dựa trên sự tương đồng nội dung (content similarity) với một game cụ thể, không phụ thuộc vào user profile hay lịch sử tương tác.
Mục đích sử dụng:
-	Trang chi tiết game: “Similar Games” section
-	“If you like X, you might like...”
-	“More games like this”
-	Cold-start cho user mới (chưa có lịch sử)
-	Browse by similarity
Ưu điểm:
-	Không phụ thuộc user data (giải quyết cold-start)
-	Context-aware (dựa vào game đang xem)
-	Dễ giải thích (similar genre, publisher, gameplay)
-	Consistent (không thay đổi theo user)
Nhược điểm:
-	Không cá nhân hóa theo user
-	Có thể gợi ý game user không thích
-	Không xét đến user preferences
1.4.2 Cách hoạt động chi tiết
Bước 1: Xây dựng Game Feature Vector
Hệ thống sử dụng 2 loại features chính:
A. Text Features (xử lý bằng TF-IDF):
-	Genre: Action, RPG, Strategy, etc. (lặp lại 3 lần để tăng trọng số)
-	Publisher: EA, Ubisoft, Rockstar, etc.
-	Age Rating: Everyone, Teen, Mature
-	Platform: Windows, macOS, Linux, PlayStation, Xbox
-	Mode: Single-player, Multiplayer, Co-op
-	Multiplayer: 'multiplayer' hoặc 'singleplayer'
-	Language: Ngôn ngữ hỗ trợ
-	Description: Mô tả về game (lấy 50 từ đầu)
B. Numeric Features (chuẩn hóa bằng StandardScaler):
-	Rating: Chuẩn hóa rating/5.0
-	Price: Log scale → log10(price) / 7.0
-	Downloads: Log scale → log10(downloads) / 9.0
-	Capacity (GB): Chuẩn hóa capacity / 100.0
-	Release Year: (year - 1990) / 35.0
-	CPU Score: Benchmark score / 10000.0
-	GPU Score: Benchmark score / 10000.0
-	RAM (GB): ram_gb / 32.0
Combined Feature Vector:
-	Text features được xử lý bằng TF-IDF (max 1000 features)
-	Numeric features được chuẩn hóa bằng StandardScaler (8 features)
-	Kết hợp: Combined Matrix = Text Features (1×) + Numeric Features (0.5×)
-	Tổng dimensions: ~1008 (1000 text + 8 numeric)
Bước 2: Tính Content Similarity Matrix
Pre-computation (khi khởi động hệ thống):
-	Tính cosine similarity giữa TẤT CẢ cặp games
-	Similarity matrix: N_games × N_games (full matrix)
-	Công thức: cosine_sim(A, B) = (A · B) / (||A|| × ||B||)
-	Matrix được lưu trong memory để truy cập nhanh
Weighting Features:
-	Text features: weight × 1.0 (quan trọng nhất)
-	Numerical features: weight × 0.5
-	Genre: Lặp lại 3 lần để tăng trọng số (genre rất quan trọng)
Bước 3: Lấy Similar Games cho Game X
Input:
-	game_id: ID của game đang xem (VD: GTA V)
-	top_n: Số lượng games tương tự muốn lấy (default 10)
Process:
1. Lấy similarity scores của game X với tất cả games khác
2. Sắp xếp games theo similarity giảm dần
3. Loại bỏ chính game X
4. Lấy top N games có similarity cao nhất
Output:
-	List of N similar games với similarity scores
-	VD: GTA V → [Red Dead Redemption 2 (0.89), Watch Dogs 2 (0.85), ...]
Bước 4: Giải thích độ tương đồng
Phân tích tại sao game Y similar với game X:
-	Genre match: Cùng thể loại (Action, Open World)
-	Publisher match: Cùng nhà phát hành (Rockstar)
-	Gameplay similarity: Extracted từ keywords (open-world, third-person)
-	Platform match: Cùng platform (Windows, PlayStation)
-	Price range: Cùng phân khúc giá
-	Age rating: Cùng độ tuổi (Mature 17+)
Bước 5: Diversification (tùy chọn)
Tránh gợi ý quá nhiều games giống nhau:
-	Chọn top 20 similar games
-	Rerank để đảm bảo diversity:
o	Ít nhất 3 genres khác nhau
o	Ít nhất 2 publishers khác nhau
o	Mix price ranges
-	MMR (Maximal Marginal Relevance) algorithm
-	Trả về 10 games diverse nhất
1.4.3 Ví dụ minh họa
Game đang xem: The Witcher 3: Wild Hunt
Feature analysis:
-	Genre: RPG, Open World, Fantasy
-	Publisher: CD Projekt Red
-	Keywords: story-rich, open-world, fantasy, magic, choices-matter
-	Platform: Windows, PlayStation, Xbox
-	Price: 799,000 VND
-	Rating: 4.9/5
-	Age: Mature 17+
Top 10 Similar Games:
1. Cyberpunk 2077 (similarity: 0.87)
2. Skyrim (similarity: 0.84)
3. Dragon Age: Inquisition (similarity: 0.82)
4. Red Dead Redemption 2 (similarity: 0.79)
5. Assassin's Creed Odyssey (similarity: 0.78)
6. Horizon Zero Dawn (similarity: 0.76)
7. Kingdom Come: Deliverance (similarity: 0.74)
8. Divinity: Original Sin 2 (similarity: 0.73)
9. Middle-earth: Shadow of War (similarity: 0.71)
10. Elden Ring (similarity: 0.70)
1.5 So sánh 3 loại gợi ý
1.5.1 Bảng so sánh tổng hợp
Tiêu chí	All-time	7-day Recent	Similar Games
Dữ liệu đầu vào	Toàn bộ lịch sử user	Chỉ 7 ngày gần đây	Thuộc tính game cụ thể
Phụ thuộc user	Có (user-specific)	Có (user-specific)	Không (game-specific)
Cá nhân hóa	Cao	Rất cao	Không
Độ ổn định	Ổn định	Thay đổi liên tục	Rất ổn định
Phù hợp cho	Trang chủ, email	Profile, trending	Chi tiết game
Tần suất cập nhật (Update frequency)	Hàng ngày	Real-time	Pre-computed
Chi phí tính toán (Computational cost)	Trung bình	Thấp (ít data)	Rất thấp
Giải thích (Explainability)	Phức tạp	Rất phức tạp	Dễ giải thích
Độ đa dạng (Diversity)	Cao	Thấp	Trung bình

1.5.2 Khi nào sử dụng loại nào?
Sử dụng All-time Recommendations khi:
-	Hiển thị gợi ý tổng quát trên trang chủ
-	User có lịch sử tương tác đầy đủ
-	Cần gợi ý ổn định, không thay đổi đột ngột
-	“For You” section - gợi ý cá nhân
Sử dụng 7-day Recent Recommendations khi:
-	Push notification về games mới phù hợp
-	User có sở thích đang thay đổi
-	Muốn phát hiện xu hướng cá nhân mới
-	“Trending for You” section
Sử dụng Similar Games Recommendations khi:
-	Trang chi tiết game: “You may also like”
-	User mới chưa có lịch sử
-	Browse by similarity: “More like this”
-	Không cần cá nhân hóa
-	Giới thiệu game cùng series/franchise
2. Kỹ thuật và công nghệ sử dụng 
2.1 SVD (Singular Value Decomposition)
-	Phân tích ma trận user-item thành 3 ma trận: U × Σ × V^T
-	Tham số k=2 (latent factors)
-	Scipy.sparse.linalg.svds
-	Predicted_ratings = U × Σ × V^T + user_mean
2.2 Content-Based với TF-IDF
-	TF-IDF cho text features (description, tags, keywords)
-	Cosine similarity giữa game vectors
-	Pre-computed content similarity matrix
2.3 Demographic Filtering
-	Tìm users có age và gender tương tự
-	Tính demographic similarity:
o	Age difference penalty: giảm 0.2 mỗi năm chênh lệch
o	Gender match: same = 1.0, different = 0.5
2.4 Ensemble và Dynamic Weighting
Hệ thống kết hợp 4 phương pháp với trọng số động:

A. Trọng số cho USER CÓ LỊCH SỬ (Regular User):

SVD-based Collaborative Filtering:
-	Weight: 45% (không có keyword) hoặc 15% (có keyword)
-	Dựa trên ma trận phân tích SVD
-	Tìm pattern ẩn trong hành vi user

Content-Based Filtering:
-	Weight: 35% (không có keyword) hoặc 15% (có keyword)
-	Dựa trên thuộc tính game: genre, platform, publisher, price, etc.
-	Sử dụng TF-IDF cho text features
-	Cosine similarity giữa game vectors

Demographic Filtering:
-	Weight: 20% (không có keyword) hoặc 10% (có keyword)
-	Dựa trên tuổi và giới tính của user
-	Tìm user có demographic tương tự
-	Gợi ý game mà các user tương tự thích

Keyword-Based Filtering:
-	Weight: 0% (không có keyword) hoặc 60% (có keyword)
-	Mở rộng query thông qua library.json:
    o	Hàm expand_query() tìm kiếm trong keyword_library
    o	Map từ tiếng Việt sang tiếng Anh + synonyms
    o	VD: "chiến thuật" → "chiến thuật strategy tactic tactical turn-based"
-	Tính điểm match với field weights (hàm get_keyword_score):
    o	name: 3.0× (quan trọng nhất)
    o	genre: 2.5× (rất quan trọng)
    o	description: 2.0×
    o	publisher, platform, language: 1.5×
-	Ưu tiên cao khi user tìm kiếm bằng keyword

B. Trọng số cho COLD START USER (không có lịch sử):

KHÔNG có keyword:
-	SVD: 70% (collaborative filtering từ user tương tự)
-	Content: 0% (không có lịch sử → không tính)
-	Demographic: 30% (dựa trên age/gender)
-	Keyword: 0%

CÓ keyword:
-	SVD: 30%
-	Content: 0%
-	Demographic: 10%
-	Keyword: 60% (ưu tiên tìm kiếm)

C. Dynamic Weight Adjustment (dựa trên user behavior):
Hệ thống tự động điều chỉnh trọng số dựa trên hành vi user:

1. User có xu hướng khám phá ngoài top recommendations:
   -	Phát hiện: ratio_outside_top10 > 0.5
   -	Điều chỉnh: Giảm keyword weight TỪNG BƯỚC (gradient)
   -	Công thức: keyword_reduction = (ratio - 0.5) × 50%
   -	Phân bổ lại cho content và demographic

2. User có sở thích mạnh (publisher/genre):
   -	Phát hiện: preference_strength > 0.7
   -	Điều chỉnh: Tăng content weight từ 0.15 → 0.25
   -	Giảm SVD và demographic để tập trung vào content matching

Final Score Calculation:
-	Final_score = (svd_score × svd_weight) + (content_score × content_weight) + (demo_score × demo_weight) + (keyword_score × keyword_weight)
-	Tất cả scores được normalize về [0, 1] trước khi kết hợp
-	Validation: sum(weights) == 1.0
-	Sắp xếp theo final_score giảm dần
-	Trả về top N recommendations

2.4.1 Chi tiết về Keyword Expansion (library.json)
File library.json chứa 74 categories với keyword mapping từ tiếng Việt sang tiếng Anh:

Cấu trúc:
{
  "keywords": {
    "Action": "hành động hanh dong chiến đấu bắn nhau action fighting combat...",
    "Horror": "kinh dị đáng sợ ma quái horror scary frightening creepy...",
    "cheap": "game giá rẻ tiền giá rẻ low price affordable budget...",
    ...
  }
}

Các nhóm keyword chính:
A. Game Genres (thể loại):
-	Action, Horror, Shooter, Strategy, Adventure, RPG, Puzzle, Casual
-	Simulation, Sports, Fighting, Board, Party, Platformer
-	Fantasy, Sci-Fi, Racing, Stealth, Survival, Tower Defense
-	MOBA, MMORPG, Battle Royale, Sandbox, Roguelike, Metroidvania
-	Visual Novel, Rhythm, Educational, Trivia

B. Price & Value (giá cả):
-	cheap: "game giá rẻ tiền giá rẻ low price affordable budget"
-	expensive: "game giá đắt giá cao expensive premium luxury AAA"
-	free: "game miễn phí free gratis không mất tiền"
-	on sale: "game giảm giá sale discount promotion"

C. Multiplayer & Mode (chế độ):
-	multiplayer: "đa người chơi nhiều người online co-op cooperative"
-	offline: "game offline chơi một người single player solo"
-	local co-op: "chơi cùng nhau local co-op split screen"
-	competitive: "cạnh tranh competitive esports tournament"

D. Platforms (nền tảng):
-	mobile, pc, console, vr, cross-platform

E. Emotions & Feelings (cảm xúc):
-	exciting: "thú vị exciting thrilling adrenaline rush"
-	relaxing: "thư giãn relaxing peaceful calm zen"
-	challenging: "thử thách challenging difficult hard skill"
-	scary: "đáng sợ scary frightening horror"

F. Languages (ngôn ngữ):
-	vietnamese, english, japanese, korean, chinese

Hàm expand_query():
```python
def expand_query(self, query):
    # Chuyển query thành lowercase
    query = query.lower().strip()
    expanded_keywords = set()
    
    # Thêm query gốc
    expanded_keywords.add(query)
    
    # Tách query theo dấu phẩy (multi-phrase)
    query_phrases = [phrase.strip() for phrase in query.split(',')]
    
    # Tìm kiếm trong library
    for english_key, vietnamese_synonyms in keyword_library.items():
        vietnamese_synonyms = vietnamese_synonyms.lower()
        
        for phrase in query_phrases:
            # Kiểm tra phrase có xuất hiện trong synonyms không
            if phrase in vietnamese_synonyms:
                # Thêm english_key vào expanded keywords
                expanded_keywords.add(english_key.lower())
    
    # Kết hợp tất cả keywords (chỉ mở rộng 1 lần, không đệ quy)
    return ' '.join(expanded_keywords)
```

Ví dụ expand_query:
-	Input: "hành động"
    Output: "hành động action"
-	Input: "game giá rẻ"
    Output: "game giá rẻ cheap"
-	Input: "chiến thuật, kịch tính"
    Output: "chiến thuật kịch tính strategy action"
-	Input: "horror"
    Output: "horror"

Hàm get_keyword_score(game, keyword):
```python
def get_keyword_score(self, game, keyword):
    # Mở rộng keyword
    expanded_keyword = self.expand_query(keyword)
    keywords_to_search = expanded_keyword.lower().split()
    
    score = 0.0
    searchable_fields = {
        'name': 3.0,           # Tên game quan trọng nhất
        'description': 2.0,    # Mô tả quan trọng thứ 2
        'genre': 2.5,          # Genre quan trọng
        'publisher': 1.5,      # Publisher
        'platform': 1.5,       # Platform
        'language': 1.5        # Language
    }
    
    # Tìm keyword trong từng field
    for field_name, field_weight in searchable_fields.items():
        field_value = game.get(field_name, '')
        
        # Convert to string (handle list)
        if isinstance(field_value, list):
            field_value = ' '.join(field_value)
        field_value = field_value.lower()
        
        # Count matches
        for kw in keywords_to_search:
            if kw in field_value:
                score += field_weight
    
    # Normalize
    return min(score / 10.0, 1.0)
```

2.5 Deployment và API
API Integration:
-	Unified AI Service (unified_ai_service.py) - Flask microservice
-	Backend TypeScript (recommendationController.ts) - Node.js/Express
-	Endpoint chính:
o	POST /api/recommend: Gợi ý cá nhân hóa cho user
o	POST /api/similar-games: Gợi ý game tương tự (content-based)
o	GET /health: Health check
-	Input:
o	user_id: ID của user cần gợi ý
o	query (optional): Từ khóa tìm kiếm (VD: "hành động", "game giá rẻ")
o	days (optional): Số ngày gần đây (7 = recent 7-day, null = all-time)
o	top_n: Số lượng gợi ý (default=10)
-	Output: JSON với game recommendations và scores

Quy trình xử lý query (keyword search):
1. Frontend gửi request với query (VD: "game hành động")
2. Backend (TypeScript) nhận request:
   -	Endpoint: GET /recommendations?user_id=1&query=game%20hành%20động&days=7
   -	Extract parameters: user_id, query, days
   -	Prepare game data và user data từ MySQL database
3. Backend gọi AI Service (Python):
   -	POST http://localhost:5000/api/recommend
   -	Body: { user_id, games, users, query, days, top_n }
4. AI Service xử lý query:
   -	Load library.json vào keyword_library
   -	Gọi expand_query(query) để mở rộng keyword:
       * Tìm trong keyword_library
       * Map tiếng Việt → tiếng Anh + synonyms
       * VD: "hành động" → "hành động action fighting combat fast-paced"
   -	Gọi get_keyword_score(game, expanded_query) cho từng game:
       * Tìm keyword trong các field (name, genre, description, etc.)
       * Áp dụng field weights (name: 3.0, genre: 2.5, etc.)
       * Trả về keyword_score
   -	Tính hybrid_score với keyword weight = 60%
5. AI Service trả về recommendations cho Backend
6. Backend transform dữ liệu và trả về Frontend
Data Storage:
-	MySQL database (backend) cho persistent data:
o	game, user, publisher, genre, platform, language
o	purchase, wishlist, review, view
o	Lấy data real-time từ MySQL
-	library.json (AI service) cho keyword mapping:
o	Key: English category (VD: "Action", "Strategy", "cheap")
o	Value: Vietnamese synonyms + English synonyms
o	74 categories được define
-	SQLite database (user_interactions.db) cho tracking:
o	Lưu lịch sử interactions (view, purchase, favorite)
o	Timestamps cho temporal analysis
o	Schema: user_id, game_id, interaction_type, timestamp, rating
Temporal Impact Implementation:
-	Lọc interactions theo cutoff date (recent_days parameter)
-	SQLite query: WHERE timestamp >= (now - recent_days)
-	Ví dụ: recent_days=7 → chỉ lấy interactions 7 ngày vừa qua
-	Fallback JSON timestamps nếu không có SQLite
User Preference Analysis:
-	Tự động phân tích sở thích từ interactions
-	Xác định:
o	Top preferred publishers
o	Top preferred genres  
o	Top preferred platforms
o	Preferred keywords
-	Cập nhật real-time khi có interaction mới
Performance:
-	Pre-compute SVD model và content similarity matrix
-	Load models vào memory khi khởi động
-	Response time: < 500ms cho most queries
-	Hỗ trợ batch recommendations
Visualization:
-	Matplotlib charts cho phân tích:
o	User-game relationship heatmap
o	User similarity heatmap
o	Temporal impact visualization
o	Content comparison charts
-	Export charts dạng PNG
Monitoring và Logging:
-	Print logs cho mỗi recommendation request
-	Track số lượng recommendations đã generate
-	Log errors và exceptions
-	Lưu interaction history vào database
3. Kết luận về hệ thống gợi ý thông minh 
Hệ thống gợi ý game được thiết kế với 3 loại gợi ý khác nhau, mỗi loại phục vụ mục đích riêng:
3.1 All-time Recommendations
-	Phù hợp cho gợi ý tổng quát, ổn định
-	Phản ánh sở thích lâu dài của user
3.2 7-day Recent Recommendations
-	Phát hiện xu hướng và sở thích đang thay đổi
-	Dynamic, cập nhật liên tục
3.3 Similar Games Recommendations
-	Dựa trên content similarity
-	Không phụ thuộc user, giải quyết cold-start
-	Sử dụng trên trang chi tiết game
Ưu điểm của hệ thống:
-	Kết hợp 4 phương pháp: SVD, Content-based, Demographic, Keyword
-	Dynamic weighting tự động điều chỉnh trọng số
-	Adaptive boosting dựa trên user preferences
-	Temporal decay ưu tiên hành vi gần đây (cho 7-day)
-	Pre-computed models cho inference nhanh
